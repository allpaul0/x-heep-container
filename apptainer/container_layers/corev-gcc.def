Bootstrap: localimage
From: container_layers/build/gcc.sif

%environment
    export COREV=/opt/tools/corev
    export PATH=${COREV}/bin:$PATH

%post
    # Set non-interactive frontend to avoid prompt
    export DEBIAN_FRONTEND=noninteractive

    apt-get update && apt-get install -y gcc-multilib \
    autoconf automake autotools-dev curl python3 python3-pip \
    python3-tomli libmpc-dev libmpfr-dev libgmp-dev gawk \
    build-essential bison flex texinfo gperf libtool patchutils \
    bc zlib1g-dev libexpat-dev ninja-build git cmake libglib2.0-dev libslirp-dev

    cd /opt
    mkdir -p /corev
    wget -qO- https://buildbot.embecosm.com/job/corev-gcc-ubuntu2204/47/artifact/corev-openhw-gcc-ubuntu2204-20240530.tar.gz | tar -xz -C /corev
    mkdir -p /opt/tools/corev
    mv /corev/corev-openhw-gcc-ubuntu2204-20240530 /opt/tools/corev